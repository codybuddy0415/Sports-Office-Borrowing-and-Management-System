<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sports Equipment Borrowing System</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=Manrope:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        /* Light Theme Colors */
        --primary: #2563eb;
        --primary-dark: #1d4ed8;
        --primary-light: #3b82f6;
        --secondary: #06b6d4;
        --accent: #f59e0b;
        --success: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
        --dark: #0f172a;
        --dark-secondary: #1e293b;
        --light-bg: #f8fafc;
        --card-bg: #ffffff;
        --text-primary: #0f172a;
        --text-secondary: #64748b;
        --border: #e2e8f0;
        --shadow-sm: 0 2px 8px rgba(15, 23, 42, 0.04);
        --shadow-md: 0 4px 16px rgba(15, 23, 42, 0.08);
        --shadow-lg: 0 12px 32px rgba(15, 23, 42, 0.12);
        --shadow-hover: 0 16px 48px rgba(37, 99, 235, 0.15);
      }

      body.dark {
        --primary: #3b82f6;
        --primary-dark: #2563eb;
        --primary-light: #60a5fa;
        --light-bg: #0a0e1a;
        --card-bg: #0f172a;
        --text-primary: #f1f5f9;
        --text-secondary: #94a3b8;
        --border: #1e293b;
        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
        --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
        --shadow-lg: 0 12px 32px rgba(0, 0, 0, 0.5);
        --shadow-hover: 0 16px 48px rgba(59, 130, 246, 0.2);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Manrope", -apple-system, BlinkMacSystemFont, sans-serif;
        background: var(--light-bg);
        color: var(--text-primary);
        transition: background 0.3s ease, color 0.3s ease;
      }

      /* Typography */
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: "Outfit", sans-serif;
        font-weight: 700;
      }

      h1 {
        font-size: 32px;
        margin-bottom: 8px;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Top Header */
      .top-header {
        height: 70px;
        background: var(--card-bg);
        border-bottom: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 32px;
        box-shadow: var(--shadow-sm);
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
      }

      .top-header h2 {
        font-size: 20px;
        font-weight: 700;
        color: var(--text-primary);
        font-family: "Outfit", sans-serif;
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 20px;
        font-size: 14px;
        color: var(--text-secondary);
      }

      .theme-toggle {
        background: var(--light-bg);
        border: 1px solid var(--border);
        cursor: pointer;
        font-size: 18px;
        color: var(--text-primary);
        width: 40px;
        height: 40px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
      }

      .theme-toggle:hover {
        background: var(--primary);
        color: white;
        transform: rotate(180deg);
        box-shadow: var(--shadow-md);
      }

      /* Container */
      .container {
        display: flex;
        min-height: calc(100vh - 70px);
      }

      /* Sidebar */
      .sidebar {
        width: 280px;
        background: var(--card-bg);
        border-right: 1px solid var(--border);
        padding: 24px;
        display: flex;
        flex-direction: column;
        box-shadow: var(--shadow-sm);
        transition: all 0.3s ease;
      }

      .sidebar-logo {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 32px;
        padding: 20px;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        border-radius: 16px;
        box-shadow: var(--shadow-md);
      }

      .sidebar-logo img {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        object-fit: cover;
        border: 4px solid rgba(255, 255, 255, 0.2);
        margin-bottom: 12px;
        transition: transform 0.3s ease;
      }

      .sidebar-logo:hover img {
        transform: scale(1.05) rotate(5deg);
      }

      .sidebar-logo h3 {
        color: white;
        font-size: 16px;
        font-weight: 600;
        text-align: center;
      }

      .sidebar button {
        width: 100%;
        padding: 14px 18px;
        margin-bottom: 8px;
        border: none;
        background: var(--light-bg);
        color: var(--text-primary);
        border-radius: 12px;
        cursor: pointer;
        font-size: 15px;
        font-weight: 600;
        font-family: "Manrope", sans-serif;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }

      .sidebar button::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: var(--primary);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
        z-index: 0;
      }

      .sidebar button:hover::before {
        width: 300px;
        height: 300px;
      }

      .sidebar button:hover {
        color: white;
        transform: translateX(4px);
        box-shadow: var(--shadow-md);
      }

      .sidebar button i {
        margin-right: 10px;
        position: relative;
        z-index: 1;
      }

      .sidebar button span {
        position: relative;
        z-index: 1;
      }

      .sidebar button.active {
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: white;
        box-shadow: var(--shadow-md);
      }

      .sidebar button.logout {
        background: linear-gradient(135deg, #dc2626, #991b1b);
        color: white;
        margin-top: auto;
      }

      .sidebar button.logout:hover {
        transform: translateX(4px);
        box-shadow: var(--shadow-lg);
      }

      /* Admin Profile */
      .admin-profile {
        display: flex;
        align-items: center;
        gap: 12px;
        background: var(--light-bg);
        padding: 14px;
        border-radius: 12px;
        margin-bottom: 16px;
        border: 1px solid var(--border);
        transition: all 0.3s ease;
      }

      .admin-profile:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-2px);
      }

      .admin-profile img {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid var(--primary);
      }

      .admin-profile div {
        display: flex;
        flex-direction: column;
      }

      .admin-profile strong {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-primary);
      }

      .admin-profile span {
        font-size: 12px;
        color: var(--text-secondary);
      }

      /* Main Content */
      .main {
        flex: 1;
        padding: 32px;
        overflow: auto;
        position: relative;
        background: var(--light-bg);
      }

      /* Dashboard Stats */
      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
      }

      /* Dashboard Cards */
      .dash-card {
        background: var(--card-bg);
        border-radius: 20px;
        overflow: hidden;
        box-shadow: var(--shadow-md);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid var(--border);
        position: relative;
      }

      .dash-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        transform: scaleX(0);
        transition: transform 0.3s ease;
      }

      .dash-card:hover::before {
        transform: scaleX(1);
      }

      .dash-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-hover);
      }

      .dash-top {
        background: linear-gradient(135deg, var(--light-bg), transparent);
        padding: 20px 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 13px;
        font-weight: 700;
        color: var(--text-secondary);
        letter-spacing: 1px;
        text-transform: uppercase;
      }

      .dash-top i {
        font-size: 24px;
        color: var(--primary);
        opacity: 0.7;
        transition: all 0.3s ease;
      }

      .dash-card:hover .dash-top i {
        opacity: 1;
        transform: scale(1.1) rotate(5deg);
      }

      .dash-body {
        padding: 24px;
        text-align: center;
      }

      .dash-body h2 {
        font-size: 48px;
        font-weight: 800;
        margin: 0;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        transition: all 0.3s ease;
      }

      .dash-sub {
        font-size: 13px;
        color: var(--text-secondary);
        margin-top: 8px;
        font-weight: 500;
      }

      /* Sections */
      .section {
        background: var(--card-bg);
        padding: 28px;
        border-radius: 20px;
        margin-bottom: 24px;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-md);
        transition: all 0.3s ease;
      }

      .section:hover {
        box-shadow: var(--shadow-lg);
      }

      .section h3 {
        margin-bottom: 20px;
        font-size: 20px;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 12px;
      }

      /* Warning Section */
      #warningSection {
        background: linear-gradient(135deg, #fef2f2, #fee2e2);
        border-left: 4px solid var(--danger);
      }

      body.dark #warningSection {
        background: linear-gradient(135deg, #450a0a, #7f1d1d);
      }

      #warnings li {
        padding: 8px 0;
        font-weight: 600;
        list-style: none;
        padding-left: 24px;
        position: relative;
      }

      #warnings li::before {
        content: "âš ";
        position: absolute;
        left: 0;
        font-size: 16px;
      }

      /* Tables */
      .table-box {
        background: var(--card-bg);
        border-radius: 16px;
        overflow: hidden;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-md);
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      thead {
        background: linear-gradient(135deg, var(--light-bg), transparent);
      }

      th {
        padding: 16px;
        text-align: left;
        font-weight: 700;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--text-secondary);
        border-bottom: 2px solid var(--border);
      }

      td {
        padding: 16px;
        border-bottom: 1px solid var(--border);
        font-size: 14px;
        color: var(--text-primary);
      }

      tbody tr {
        transition: all 0.2s ease;
      }

      tbody tr:hover {
        background: var(--light-bg);
        transform: scale(1.01);
      }

      /* Badges */
      .badge {
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 700;
        display: inline-block;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .badge.new {
        background: linear-gradient(135deg, #ecfeff, #cffafe);
        color: #155e75;
      }

      .badge.good {
        background: linear-gradient(135deg, #dcfce7, #bbf7d0);
        color: #166534;
      }

      .badge.fair {
        background: linear-gradient(135deg, #fef3c7, #fde68a);
        color: #92400e;
      }

      .badge.bad {
        background: linear-gradient(135deg, #fee2e2, #fecaca);
        color: #991b1b;
      }

      /* Status Pills */
      .status-pill {
        padding: 6px 16px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 700;
        color: white;
        display: inline-block;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .status-pill.borrowed {
        background: linear-gradient(135deg, #f59e0b, #d97706);
      }

      .status-pill.returned {
        background: linear-gradient(135deg, #10b981, #059669);
      }

      .status-pill.overdue {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      /* Actions */
      .actions {
        display: flex;
        gap: 12px;
        align-items: center;
      }

      .actions i {
        cursor: pointer;
        color: var(--text-secondary);
        font-size: 16px;
        transition: all 0.2s ease;
      }

      .actions i:hover {
        color: var(--primary);
        transform: scale(1.2);
      }

      .actions .fa-trash:hover {
        color: var(--danger);
      }

      /* Inputs */
      input,
      select {
        width: 100%;
        padding: 12px 16px;
        margin-bottom: 16px;
        border: 2px solid var(--border);
        border-radius: 12px;
        font-size: 14px;
        font-family: "Manrope", sans-serif;
        background: var(--card-bg);
        color: var(--text-primary);
        transition: all 0.3s ease;
      }

      input:focus,
      select:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
      }

      /* Buttons */
      button.action {
        background: linear-gradient(135deg, var(--success), #059669);
        border: none;
        color: white;
        padding: 10px 20px;
        border-radius: 12px;
        cursor: pointer;
        font-weight: 600;
        font-family: "Manrope", sans-serif;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
      }

      button.action:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      button.return {
        background: linear-gradient(135deg, #f59e0b, #d97706);
      }

      button.print {
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      }

      button.filter {
        background: linear-gradient(135deg, var(--secondary), #0891b2);
      }

      button.reset {
        background: linear-gradient(135deg, #64748b, #475569);
      }

      /* Top Actions */
      .top-actions {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        gap: 12px;
        margin-bottom: 24px;
        flex-wrap: wrap;
      }

      .top-actions input[type="text"] {
        width: 300px;
        margin-bottom: 0;
      }

      .add-btn,
      .add-loan-btn {
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 12px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
      }

      .add-btn:hover,
      .add-loan-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      /* Modal */
      .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(8px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .modal-box {
        background: var(--card-bg);
        width: 480px;
        max-width: 90%;
        padding: 32px;
        border-radius: 20px;
        box-shadow: var(--shadow-lg);
        position: relative;
        border: 1px solid var(--border);
        animation: slideUp 0.3s ease;
      }

      @keyframes slideUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .modal-box h2 {
        margin-bottom: 24px;
        color: var(--text-primary);
      }

      .modal-close {
        position: absolute;
        top: 16px;
        right: 16px;
        font-size: 20px;
        cursor: pointer;
        color: var(--text-secondary);
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        transition: all 0.2s ease;
      }

      .modal-close:hover {
        background: var(--light-bg);
        color: var(--danger);
        transform: rotate(90deg);
      }

      /* Hidden */
      .hidden {
        display: none !important;
      }

      /* Responsive */
      @media (max-width: 1024px) {
        .stats {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 768px) {
        .container {
          flex-direction: column;
        }

        .sidebar {
          width: 100%;
          padding: 16px;
        }

        .sidebar button {
          font-size: 14px;
          padding: 12px;
        }

        .main {
          padding: 16px;
        }

        .stats {
          grid-template-columns: 1fr;
        }

        .top-actions {
          flex-direction: column;
        }

        .top-actions input[type="text"] {
          width: 100%;
        }

        h1 {
          font-size: 24px;
        }

        table {
          font-size: 12px;
        }

        th,
        td {
          padding: 10px;
        }
      }

      @media (max-width: 480px) {
        .top-header {
          padding: 0 16px;
          height: auto;
          flex-direction: column;
          gap: 12px;
          padding: 16px;
        }

        .dash-body h2 {
          font-size: 36px;
        }
      }

      /* Scrollbar Styling */
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }

      ::-webkit-scrollbar-track {
        background: var(--light-bg);
      }

      ::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--text-secondary);
      }
    </style>
  </head>
  <body>
    <header class="top-header">
      <h2>Sports Equipment Borrowing System</h2>
      <div class="header-right">
        <span id="currentDate"></span>
        <button class="theme-toggle" onclick="toggleTheme()">
          <i class="fas fa-moon"></i>
        </button>
      </div>
    </header>

    <div class="container">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="sidebar-logo">
          <img src="SCC logo 2.png" alt="SCC Logo" />
          <h3>SCC Sports Office</h3>
        </div>

        <button id="focusBtn" onclick="show('dashboard')">Dashboard</button>
        <button id="focusBtn" onclick="show('equipment')">Equipment</button>
        <button id="focusBtn" onclick="show('borrow')">Borrow</button>
        <button id="focusBtn" onclick="show('reports')">Reports</button>

        <div class="admin-profile">
          <img src="SCC logo 2.png" alt="Admin" />
          <div>
            <strong>Admin</strong>
            <span>Sports Office</span>
          </div>
        </div>

        <button class="logout" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>

      <!-- Main -->
      <div class="main">
        <button class="hidden" onclick="toggleTheme()"></button>

        <!-- Dashboard -->
        <div id="dashboard">
          <h1>Dashboard</h1>
          <div class="stats">
            <div class="dash-card">
              <div class="dash-top">
                <span>TOTAL EQUIPMENT</span>
                <i class="fas fa-box"></i>
              </div>
              <div class="dash-body">
                <h2 id="total">0</h2>
                <p class="dash-sub">All items in inventory</p>
              </div>
            </div>

            <div class="dash-card">
              <div class="dash-top">
                <span>BORROWED</span>
                <i class="fas fa-clipboard-list"></i>
              </div>
              <div class="dash-body">
                <h2 id="borrowed">0</h2>
                <p class="dash-sub">Currently borrowed</p>
              </div>
            </div>

            <div class="dash-card">
              <div class="dash-top">
                <span>AVAILABLE</span>
                <i class="fas fa-clipboard-check"></i>
              </div>
              <div class="dash-body">
                <h2 id="available">0</h2>
                <p class="dash-sub">Ready to use</p>
              </div>
            </div>

            <div class="dash-card">
              <div class="dash-top">
                <span>BORROWERS</span>
                <i class="fas fa-user-alt"></i>
              </div>
              <div class="dash-body">
                <h2 id="count">0</h2>
                <p class="dash-sub">Total students</p>
              </div>
            </div>
          </div>
          <div class="section hidden" id="warningSection">
  <h3>
    <i class="fas fa-warning" style="font-size: 25px; color: rgba(255, 0, 0, 0.829)"></i>
    Warnings
  </h3>
  <ul id="warnings"></ul>
</div>

          <div class="section">
            <h3>Current Borrowers</h3>
            <table>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Equipment</th>
                  <th>Qty</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody id="dashboardBorrowers"></tbody>
            </table>
          </div>
          <div class="section">
            <h3>Equipment Inventory</h3>
            <table>
              <thead>
                <tr>
                  <th>Equipment</th>
                  <th>Total</th>
                  <th>Available</th>
                  <th>Borrowed</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="dashboardInventory"></tbody>
            </table>
          </div>
        </div>

        <!-- Equipment Management -->
        <div id="equipment" class="hidden">
          <h1>Inventory Management</h1>
          <p>Track and manage sports equipment.</p>
          <div class="top-actions">
            <input
              type="text"
              placeholder="ðŸ”Žï¸Ž Search equipment..."
              onkeyup="searchEquipment(this.value)"
            />
            <button class="add-btn" onclick="toggleAddForm()">
              <i class="fas fa-plus"></i> Add Item
            </button>
          </div>
          <div id="addModal" class="modal hidden">
            <div class="modal-box">
              <div class="modal-close" onclick="toggleAddForm()">
                <i class="fas fa-times"></i>
              </div>

              <h2>Add Equipment</h2>

              <input id="eqName" placeholder="Equipment Name" />
              <input id="eqType" placeholder="Brand / Category" />
              <input id="eqQty" type="number" placeholder="Total Quantity" />

              <select id="eqCondition">
                <option>New</option>
                <option>Good</option>
                <option>Fair</option>
                <option>Bad</option>
              </select>

              <button class="action" onclick="addEquipment()">Save Item</button>
            </div>
          </div>

          <div class="table-box">
            <table>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Category</th>
                  <th>Condition</th>
                  <th>Available</th>
                  <th>Total</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="eqTable"></tbody>
            </table>
          </div>
        </div>

        <!-- Borrow Management -->
        <div id="borrow" class="hidden">
          <h1>Borrow Management</h1>
          <p>Manage student loans and returns.</p>
          <div class="top-actions">
            <input
              type="text"
              placeholder="ðŸ”Žï¸Ž Search student or item..."
              onkeyup="searchBorrowers(this.value)"
            />
            <button class="add-loan-btn" onclick="toggleBorrowForm()">
              <i class="fas fa-plus"></i> New Loan
            </button>
          </div>
          <div id="borrowModal" class="modal hidden">
            <div class="modal-box">
              <div class="modal-close" onclick="toggleBorrowForm()">
                <i class="fas fa-times"></i>
              </div>

              <h2>New Loan</h2>

              <input id="bName" placeholder="Borrower Name" />
              <input id="bID" placeholder="ID Number" />
              <input id="bCourse" placeholder="Purpose" />

              <select id="bEquip"></select>

              <input id="bQty" type="number" placeholder="Quantity" />
              <input id="bDue" type="date" />

              <button class="action" onclick="borrow()">Save Loan</button>
            </div>
          </div>

          <div class="table-box">
            <table>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>ID</th>
                  <th>Purpose</th>
                  <th>Equipment</th>
                  <th>Qty</th>
                  <th>Status</th>
                  <th>Borrowed</th>
                  <th>Due</th>
                  <th>Returned</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="borrowTable"></tbody>
            </table>
          </div>
        </div>

        <!-- Reports -->
        <div id="reports" class="hidden">
          <h1>Reports</h1>
          <div class="top-actions">
            <button class="action filter" onclick="toggleFilterModal()">
              <i class="fas fa-filter"></i> Filter
            </button>
            <button class="action print" onclick="window.print()">
              Print / PDF
            </button>
          </div>
          <div id="filterModal" class="modal hidden">
            <div class="modal-box">
              <div class="modal-close" onclick="toggleFilterModal()">
                <i class="fas fa-times"></i>
              </div>

              <h3>Filter Reports</h3>

              <label>From Date</label>
              <input type="date" id="fromDate" />

              <label>To Date</label>
              <input type="date" id="toDate" />

              <div style="display: flex; gap: 10px; margin-top: 15px">
                <button class="action filter" onclick="applyReportFilter()">
                  Apply
                </button>
                <button class="action reset" onclick="resetReports()">
                  Reset
                </button>
              </div>
            </div>
          </div>
          <div class="section">
            <h3>Current Borrowers</h3>
            <table>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>ID</th>
                  <th>Equipment</th>
                  <th>Qty</th>
                  <th>Status</th>
                  <th>Borrowed</th>
                </tr>
              </thead>
              <tbody id="reportBorrowers"></tbody>
            </table>
          </div>
          <div class="section">
            <h3>Equipment Inventory</h3>
            <table>
              <thead>
                <tr>
                  <th>Equipment</th>
                  <th>Total</th>
                  <th>Available</th>
                  <th>Borrowed</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody id="reportInventory"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Initialize storage
      let equipments = JSON.parse(localStorage.getItem("equipments")) || [];
      let borrowers = JSON.parse(localStorage.getItem("borrowers")) || [];

      // Show date
      document.getElementById("currentDate").textContent =
        new Date().toDateString();

      // Navigation
      function show(id) {
        document
          .querySelectorAll(".main>div")
          .forEach((d) => d.classList.add("hidden"));
        document.getElementById(id).classList.remove("hidden");
      }

      // Dark mode
      function toggleTheme() {
        document.body.classList.toggle("dark");

        const icon = document.querySelector(".theme-toggle i");

        if (document.body.classList.contains("dark")) {
          icon.classList.remove("fa-moon");
          icon.classList.add("fa-sun");
        } else {
          icon.classList.remove("fa-sun");
          icon.classList.add("fa-moon");
        }
      }

      // Toggle forms
      function toggleAddForm() {
        document.getElementById("addModal").classList.toggle("hidden");
      }

      function toggleBorrowForm() {
        document.getElementById("borrowModal").classList.toggle("hidden");
      }
      function toggleFilterModal() {
        document.getElementById("filterModal").classList.toggle("hidden");
      }
      // Close modal when clicking outside the modal box
      document.addEventListener("click", function (e) {
        if (e.target.classList.contains("modal")) {
          e.target.classList.add("hidden");
        }
      });

      // Logout
      function logout() {
        if (confirm("Logout?")) window.location.href = "index.html";
      }

      // Save to localStorage
      function save() {
        localStorage.setItem("equipments", JSON.stringify(equipments));
        localStorage.setItem("borrowers", JSON.stringify(borrowers));
      }
      
      // Render all
      function render() {
        let eqTable = document.getElementById("eqTable");
        let bEquip = document.getElementById("bEquip");
        let borrowTable = document.getElementById("borrowTable");
        let dashboardBorrowers = document.getElementById("dashboardBorrowers");
        let dashboardInventory = document.getElementById("dashboardInventory");
        let reportBorrowers = document.getElementById("reportBorrowers");
        eqTable.innerHTML =
          bEquip.innerHTML =
          borrowTable.innerHTML =
          warnings.innerHTML =
          dashboardBorrowers.innerHTML =
          dashboardInventory.innerHTML =
          reportBorrowers.innerHTML =
          
            "";

        let today = new Date().toISOString().split("T")[0];

        // Equipments
        equipments.forEach((e, i) => {
          let borrowedQty = e.total - e.avail;
          let statusClass =
            e.avail === 0 ? "bad" : e.avail <= 2 ? "fair" : "good";
          let statusText =
            e.avail === 0
              ? "Out of Stock"
              : e.avail <= 2
                ? "Low Stock"
                : "Available";
          if (e.avail === 0) {
  warnings.innerHTML += `
    <li style="color:red;font-weight:600;">
      Out of Stock: ${e.name}
    </li>`;
} else if (e.avail <= 2) {
  warnings.innerHTML += `
    <li style="color:orange;font-weight:600;">
      Low Stock: ${e.name} (${e.avail} left)
    </li>`;
}

          eqTable.innerHTML += `
            <tr>
                <td>${e.name}</td>
                <td>${e.type}</td>
                <td><span class="badge ${e.condition.toLowerCase()}">${e.condition}</span></td>
                <td>${e.avail}</td>
                <td>${e.total}</td>
                <td>
                <span class="badge ${statusClass}">${statusText}</span>
                <div class="actions">
                <i class="fas fa-pen" onclick="editEquipment(${i})"></i>
                <i class="fas fa-trash" onclick="deleteEquipment(${i})"></i>
                </div>
                </td>
            </tr>`;
          bEquip.innerHTML += `<option value="${i}">${e.name}</option>`;

          // Dashboard inventory
          dashboardInventory.innerHTML += `
            <tr>
                <td>${e.name}</td>
                <td>${e.total}</td>
                <td>${e.avail}</td>
                <td>${borrowedQty}</td>
                <td><span class="badge ${statusClass}">${statusText}</span></td>
                <td>
                  <div class="actions">
                    <i class="fas fa-pen" onclick="editEquipment(${i})" title="Edit"></i>
                    <i class="fas fa-trash" onclick="deleteEquipment(${i})" title="Delete"></i>
                  </div>
                </td>
              </tr>`;
        });

        // Borrowers
        borrowers.forEach((b, i) => {
          let status = b.status;
          let statusClass = "borrowed";
          if (status === "Returned") statusClass = "returned";
          if (status === "Borrowed" && today > b.due) {
            status = "Overdue";
            statusClass = "overdue";
            warnings.innerHTML += `<li>Overdue: ${b.name} (${b.equip})</li>`;
          }
          borrowTable.innerHTML += `
          <tr>
              <td>${b.name}</td>
              <td>${b.id}</td>
              <td>${b.course}</td>
              <td>${b.equip}</td>
              <td>${b.qty}</td>
              <td><span class="status-pill ${statusClass}">${status}</span></td>
              <td>${b.borrowed}</td>
              <td>${b.due}</td>
              <td>${b.returned}</td>
              <td>${b.status !== "Returned" ? `<button class="action return" onclick="returnItem(${i})">Return</button>` : "â€”"}</td>
            </tr>`;
          dashboardBorrowers.innerHTML += `
            <tr>
                <td>${b.name}</td>
                <td>${b.equip}</td>
                <td>${b.qty}</td>
                <td><span class="status-pill ${statusClass}">${status}</span></td>
            </tr>`;
          reportBorrowers.innerHTML += `
          <tr>
              <td>${b.name}</td>
              <td>${b.id}</td>
              <td>${b.equip}</td>
              <td>${b.qty}</td>
              <td><span class="status-pill ${statusClass}">${status}</span></td>
              <td>${b.borrowed}</td>
          </tr>`;

          let reportInventory = document.getElementById("reportInventory");
          reportInventory.innerHTML = "";

          equipments.forEach((e, i) => {
            let borrowedQty = e.total - e.avail;
            let statusClass =
              e.avail === 0 ? "bad" : e.avail <= 2 ? "fair" : "good";
            let statusText =
              e.avail === 0
                ? "Out of Stock"
                : e.avail <= 2
                  ? "Low Stock"
                  : "Available";

            reportInventory.innerHTML += `
        <tr>
          <td>${e.name}</td>
          <td>${e.total}</td>
          <td>${e.avail}</td>
          <td>${borrowedQty}</td>
          <td><span class="badge ${statusClass}">${statusText}</span></td>
        </tr>
  `;
          });
        });

        // Dashboard stats
        let totalT = equipments.reduce((s, e) => s + e.total, 0);
        let availT = equipments.reduce((s, e) => s + e.avail, 0);
        document.getElementById("total").innerText = totalT;
        document.getElementById("available").innerText = availT;
        document.getElementById("borrowed").innerText = totalT - availT;
        document.getElementById("count").innerText = borrowers.length;
        // Show or hide warning section AFTER generating warnings
if (warnings.innerHTML.trim() === "") {
  warningSection.classList.add("hidden");
} else {
  warningSection.classList.remove("hidden");
}

      }

      // Add/Edit/Delete/Return
      function addEquipment() {
        let name = document.getElementById("eqName").value;
        let type = document.getElementById("eqType").value;
        let qty = parseInt(document.getElementById("eqQty").value);
        let condition = document.getElementById("eqCondition").value;
        if (!name || !type || !qty) return alert("Fill all fields");
        equipments.push({ name, type, total: qty, avail: qty, condition });
        document.getElementById("eqName").value =
          document.getElementById("eqType").value =
          document.getElementById("eqQty").value =
            "";
        save();
        render();
        toggleAddForm();
      }

      function editEquipment(i) {
        let e = equipments[i];
        let name = prompt("Name", e.name);
        if (!name) return;
        let type = prompt("Category", e.type);
        if (!type) return;
        let total = parseInt(prompt("Total", e.total));
        if (isNaN(total)) return alert("Invalid");
        let borrowed = e.total - e.avail;
        if (total < borrowed) return alert("Cannot reduce below borrowed");
        let condition = prompt("Condition", e.condition);
        if (!condition) return;
        e.name = name;
        e.type = type;
        e.total = total;
        e.avail = total - borrowed;
        e.condition = condition;
        save();
        render();
      }

      function deleteEquipment(i) {
        if (borrowers.some((b) => b.idx === i && b.status !== "Returned"))
          return alert("Cannot delete active borrowed equipment");
        if (confirm("Delete?")) {
          equipments.splice(i, 1);
          save();
          render();
        }
      }

      function borrow() {
        let i = parseInt(document.getElementById("bEquip").value);
        let q = parseInt(document.getElementById("bQty").value);
        let due = document.getElementById("bDue").value;
        let name = document.getElementById("bName").value;
        let id = document.getElementById("bID").value;
        let course = document.getElementById("bCourse").value;
        if (q <= 0 || q > equipments[i].avail) return alert("Invalid quantity");
        if (!due) return alert("Select due date");
        equipments[i].avail -= q;
        borrowers.push({
          name,
          id,
          course,
          equip: equipments[i].name,
          idx: i,
          qty: q,
          status: "Borrowed",
          borrowed: new Date().toISOString().split("T")[0],
          due,
          returned: "â€”",
        });
        document.getElementById("bName").value =
          document.getElementById("bID").value =
          document.getElementById("bCourse").value =
          document.getElementById("bQty").value =
          document.getElementById("bDue").value =
            "";
        save();
        render();
      }

      function returnItem(i) {
        borrowers[i].status = "Returned";
        borrowers[i].returned = new Date().toISOString().split("T")[0];
        equipments[borrowers[i].idx].avail += borrowers[i].qty;
        save();
        render();
      }

      // Reports filter/reset
      function applyReportFilter() {
        let from = document.getElementById("fromDate").value;
        let to = document.getElementById("toDate").value;

        render();

        if (from || to) {
          reportBorrowers.innerHTML = "";

          borrowers
            .filter(
              (b) => (!from || b.borrowed >= from) && (!to || b.borrowed <= to),
            )
            .forEach((b) => {
              let statusClass = "borrowed";
              if (b.status === "Returned") statusClass = "returned";
              if (
                b.status === "Borrowed" &&
                new Date().toISOString().split("T")[0] > b.due
              )
                statusClass = "overdue";

              reportBorrowers.innerHTML += `
          <tr>
            <td>${b.name}</td>
            <td>${b.id}</td>
            <td>${b.equip}</td>
            <td>${b.qty}</td>
            <td><span class="status-pill ${statusClass}">${b.status}</span></td>
            <td>${b.borrowed}</td>
          </tr>`;
            });
        }

        function resetReports() {
          document.getElementById("fromDate").value = document.getElementById(
            "toDate",
          ).value = "";
          render();
          toggleFilterModal();
        }
      }

      function resetReports() {
        document.getElementById("fromDate").value = document.getElementById(
          "toDate",
        ).value = "";
        render();
      }

      function searchEquipment(keyword) {
        keyword = keyword.toLowerCase();
        let rows = document.querySelectorAll("#eqTable tr");

        rows.forEach((row) => {
          let text = row.innerText.toLowerCase();
          row.style.display = text.includes(keyword) ? "" : "none";
        });
      }

      function searchBorrowers(keyword) {
        keyword = keyword.toLowerCase();
        let rows = document.querySelectorAll("#borrowTable tr");

        rows.forEach((row) => {
          let text = row.innerText.toLowerCase();
          row.style.display = text.includes(keyword) ? "" : "none";
        });
      }

      function toggleFilterModal() {
        document.getElementById("filterModal").classList.toggle("hidden");
      }

      // Initial render
      render();
    </script>
  </body>
</html>
